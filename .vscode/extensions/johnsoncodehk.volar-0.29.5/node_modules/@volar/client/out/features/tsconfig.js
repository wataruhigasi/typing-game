"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.activate = void 0;
const vscode = require("vscode");
const shared = require("@volar/shared");
const path = require("upath");
async function activate(context, languageClient) {
    await languageClient.onReady();
    await languageClient.sendRequest(shared.InitDoneRequest.type);
    const statusBar = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Right);
    let currentTsconfig = '';
    updateStatusBar();
    vscode.window.onDidChangeActiveTextEditor(updateStatusBar, undefined, context.subscriptions);
    vscode.commands.registerCommand('volar.openTsconfig', async () => {
        const document = await vscode.workspace.openTextDocument(currentTsconfig);
        await vscode.window.showTextDocument(document);
    });
    async function updateStatusBar() {
        var _a;
        if (((_a = vscode.window.activeTextEditor) === null || _a === void 0 ? void 0 : _a.document.languageId) !== 'vue') {
            statusBar.hide();
        }
        else {
            const tsconfig = await languageClient.sendRequest(shared.GetMatchTsConfigRequest.type, languageClient.code2ProtocolConverter.asTextDocumentIdentifier(vscode.window.activeTextEditor.document));
            if (tsconfig) {
                statusBar.text = path.relative(vscode.workspace.rootPath, tsconfig);
                statusBar.command = 'volar.openTsconfig';
                currentTsconfig = tsconfig;
            }
            else {
                statusBar.text = 'No tsconfig';
                statusBar.command = undefined;
            }
            statusBar.show();
        }
    }
}
exports.activate = activate;
//# sourceMappingURL=tsconfig.js.map